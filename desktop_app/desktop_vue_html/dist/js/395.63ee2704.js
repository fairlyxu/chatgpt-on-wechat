"use strict";(self["webpackChunkdesktop_vue_html"]=self["webpackChunkdesktop_vue_html"]||[]).push([[395],{2395:function(t,e,s){s.r(e),s.d(e,{default:function(){return h}});var a=function(){var t=this,e=t._self._c;return e("el-container",{staticClass:"container is-vertical",staticStyle:{height:"100vh"}},[e("el-container",{staticClass:"main-container"},[e("el-aside",{staticStyle:{"background-color":"#545c64"},attrs:{width:"200px"}},[e("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b","default-active":t.defaultActive+""},on:{select:t.handleSelect}},[e("el-menu-item",{attrs:{index:"1"}},[t._v("小助手设置")]),e("el-menu-item",{attrs:{index:"2"}},[t._v("系统设置")])],1)],1),e("el-main",[e("el-form",{ref:"assistForm",staticClass:"assist-form",attrs:{model:t.assistFormData}},[e("div",{directives:[{name:"show",rawName:"v-show",value:1==t.activeIndex,expression:"activeIndex == 1"}],attrs:{id:"menu1"}},[e("el-form-item",{attrs:{prop:"group_chat_prefixStr",label:"群列表(请用逗号分割)"}},[e("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"群列表(请用逗号分割)"},model:{value:t.assistFormData.group_chat_prefixStr,callback:function(e){t.$set(t.assistFormData,"group_chat_prefixStr",e)},expression:"assistFormData.group_chat_prefixStr"}})],1),e("el-form-item",{attrs:{prop:"group_name_white_listStr",label:"共享会话群列表"}},[e("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"共享会话群列表"},model:{value:t.assistFormData.group_name_white_listStr,callback:function(e){t.$set(t.assistFormData,"group_name_white_listStr",e)},expression:"assistFormData.group_name_white_listStr"}})],1),e("el-form-item",{attrs:{prop:"group_chat_in_one_session",label:"触发关键词"}},[e("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"触发关键词"},model:{value:t.assistFormData.group_chat_in_one_session,callback:function(e){t.$set(t.assistFormData,"group_chat_in_one_session",e)},expression:"assistFormData.group_chat_in_one_session"}})],1),e("el-form-item",{attrs:{prop:"character_desc",label:"群助手角色描述"}},[e("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"群助手角色描述"},model:{value:t.assistFormData.character_desc,callback:function(e){t.$set(t.assistFormData,"character_desc",e)},expression:"assistFormData.character_desc"}})],1),e("el-form-item",{attrs:{prop:"subscribe_msg",label:"群助手功能描述"}},[e("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"群助手功能描述"},model:{value:t.assistFormData.subscribe_msg,callback:function(e){t.$set(t.assistFormData,"subscribe_msg",e)},expression:"assistFormData.subscribe_msg"}})],1),e("el-form-item",{attrs:{prop:"welcome_msg",label:"入群欢迎词"}},[e("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"入群欢迎词"},model:{value:t.assistFormData.welcome_msg,callback:function(e){t.$set(t.assistFormData,"welcome_msg",e)},expression:"assistFormData.welcome_msg"}})],1)],1),e("div",{directives:[{name:"show",rawName:"v-show",value:2==t.activeIndex,expression:"activeIndex == 2"}],attrs:{id:"menu2"}},[e("el-form-item",{attrs:{prop:"group_msg_switch",label:"群消息管理"}},[e("el-switch",{attrs:{"active-color":"#13ce66"},model:{value:t.assistFormData.group_msg_switch,callback:function(e){t.$set(t.assistFormData,"group_msg_switch",e)},expression:"assistFormData.group_msg_switch"}})],1)],1)])],1)],1),e("div",{staticClass:"footer"},[e("el-button",{attrs:{disabled:!t.running,type:"danger",icon:"el-icon-video-pause"},on:{click:t.stopRun}},[t._v("停止")]),e("el-button",{attrs:{disabled:t.startBtnDisabled||t.running,type:"success",icon:"el-icon-video-play"},on:{click:t.startRun}},[t._v("启动")])],1)],1)},i=[],r=s(5129);const o=(0,r.EO)();var n=!1,c={name:"Login",data(){return{defaultActive:1,activeIndex:this.defaultActive,assistFormData:{group_msg_switch:!1},startBtnDisabled:!0,running:!1}},methods:{toLoginPage(){window.pywebview.api.toLoginPage().then().catch((t=>{}))},checkToken(){return new Promise(((t,e)=>{(0,r.pK)().then((e=>{t(e)})).catch((t=>{e(t)}))}))},handleSelect(t,e){this.activeIndex=t},startRun(){this.running?this.$message.error("小助手已启动"):this.checkToken().then((()=>{let t={...this.assistFormData};t.group_chat_prefix=t.group_chat_prefixStr?t.group_chat_prefixStr.split(","):[],t.group_name_white_list=t.group_name_white_listStr?t.group_name_white_listStr.split(","):[],delete t.group_chat_prefixStr,delete t.group_name_white_listStr,this.running=!0,window.pywebview.api.startChat(t,o,(0,r.gf)()).then((t=>{})).catch((t=>{this.running=!1,this.$message.error("启动失败："+t)}))})).catch((t=>{}))},stopRun(){window.pywebview.api.stopChat(o).then((t=>{this.$message.success("成功停止"),this.running=!1,console.log("success响应",t)})).catch((t=>{console.error(t),this.$message.error(t)}))},pywebviewReadyListener(){console.log("pywebviewReady"),this.loadConfig()},loadConfig(){if(!n)try{window.pywebview.api.loadConfig(o).then((t=>{n=!0,this.assistFormData=t.data,this.assistFormData.group_chat_prefixStr="",this.assistFormData.group_chat_prefix&&(this.assistFormData.group_chat_prefixStr=this.assistFormData.group_chat_prefix.join(",")),this.assistFormData.group_name_white_listStr="",this.assistFormData.group_name_white_list&&(this.assistFormData.group_name_white_listStr=this.assistFormData.group_name_white_list.join(",")),this.startBtnDisabled=!1,this.$message.success("加载配置成功")})).catch((t=>{console.error(t),this.$message.error(t),this.startBtnDisabled=!0}))}catch(t){this.startBtnDisabled=!0}}},created(){this.checkToken().then((()=>{window.addEventListener("pywebviewready",this.pywebviewReadyListener),this.handleSelect(this.defaultActive,""),this.loadConfig()})).catch((()=>{}))},beforeDestroy(){window.removeEventListener("pywebviewready",this.pywebviewReadyListener)}},l=c,p=s(1656),m=(0,p.A)(l,a,i,!1,null,"dca375d0",null),h=m.exports}}]);
//# sourceMappingURL=395.63ee2704.js.map